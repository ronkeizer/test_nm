;; 1. Based on: run4
;; 2. Description: final model from scm
;; x1. Author: user
;; 3. Label:
$PROBLEM    PK
$INPUT      ID TIME DV AMT CMT MDV EVID WT CRCL AGE=DROP SEX CENT=DROP
$DATA       pktab1 IGNORE=@ ;
$SUBROUTINE ADVAN3 TRANS4
$PK

;;; CLCRCL-DEFINITION START
IF(CRCL.LE.88.14) CLCRCL = ( 1 + THETA(8)*(CRCL - 88.14))
IF(CRCL.GT.88.14) CLCRCL = ( 1 + THETA(9)*(CRCL - 88.14))
;;; CLCRCL-DEFINITION END


;;; V1WT-DEFINITION START
V1WT = ( 1 + THETA(7)*(WT - 66.50))
;;; V1WT-DEFINITION END


;;; V1SEX-DEFINITION START
IF(SEX.EQ.1.0000E+00) V1SEX = 1  ; Most common
IF(SEX.EQ.0.0000E+00) V1SEX = ( 1 + THETA(6))
;;; V1SEX-DEFINITION END

;;; V1-RELATION START
V1COV=V1SEX*V1WT
;;; V1-RELATION END


;;; CLWT-DEFINITION START
CLWT = ( 1 + THETA(5)*(WT - 66.50))
;;; CLWT-DEFINITION END

;;; CL-RELATION START
CLCOV=CLWT*CLCRCL
;;; CL-RELATION END


TVCL = THETA(1)

TVCL = CLCOV*TVCL
CL = TVCL * EXP(ETA(1))
TVV1 = THETA(2)

TVV1 = V1COV*TVV1
V1 = TVV1 * EXP(ETA(2))
Q  = THETA(3)
V2 = THETA(4)
S1 = V1/1000

$ERROR

IPRED = F
Y = IPRED *(1+EPS(2))+ EPS(1)
PROP = SIGMA(2,2)
ADD = SIGMA(1,1)
W = SQRT(PROP**2*IPRED**2 + ADD**2)
IRES = DV-IPRED
IWRES = IRES/W

$THETA  (0,5) ; CL
(0,97.2) ; V
(0,7.47,100) ; Q
(0,106,500) ; V2
$THETA  (-0.011,0.00977,0.030) ; CLWT1
$THETA  (-1,-0.16,5) ; V1SEX1
$THETA  (-0.011,0.0142,0.030) ; V1WT1
$THETA  (-1000000,0.0178,0.045) ; CLCRCL1
(-0.038,0.00231,1000000) ; CLCRCL2
$OMEGA  BLOCK(2)
0.0448  ;     IIV CL
0.0297 0.0512  ;     IIV V2
$SIGMA  1410  ; PAdditive error PK
0.00753  ; Proportional error PK
$ESTIMATION METHOD=1 INTER MAXEVAL=2000 NOABORT SIG=3 PRINT=1 POSTHOC

; Xpose
$TABLE ID TIME DV MDV EVID IPRED IWRES ONEHEADER NOPRINT FILE=sdtab5
$TABLE CL V1 ONEHEADER NOPRINT FILE=patab5

